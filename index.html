<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>はじめてのthree.js</title>
    <style>
      body { margin: 0; }
      canvas { width: 100%; height: 100% }
    </style>
</head>
<body>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r81/three.min.js"></script>
  <script type="text/javascript">
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );

      var renderer = new THREE.WebGLRenderer();
      renderer.setSize( window.innerWidth, window.innerHeight );
      document.body.appendChild( renderer.domElement );

      var light = new THREE.DirectionalLight(0xcccccc);
      light.position.set(0,100,30);
      scene.add(light);
      scene.add(new THREE.AmbientLight(0x666666));
      
      var loader = new THREE.TextureLoader();
      var geometry = new THREE.SphereGeometry( 1, 32, 16 );
      var material = new THREE.MeshStandardMaterial ({
        color: 0xccffcc,
        map: loader.load('earth.jpg')});
      var mesh = new THREE.Mesh( geometry, material );
      scene.add( mesh );

      // 形状データを作成
      var particle_geometry = new THREE.Geometry();
      var numParticles = 2000;
      for(var i = 0 ; i < numParticles ; i++) {
        particle_geometry.vertices.push(new THREE.Vector3(
          Math.random() * 2000 - 1000,
          Math.random() * 2000 - 1000,
          Math.random() * 2000 - 1000));
      }
       
      // マテリアルを作成
      var particle_material = new THREE.ParticleBasicMaterial({
        size: 10, color: 0xff8888, blending: THREE.AdditiveBlending,
        transparent: true, depthTest: false });
       
      // 物体を作成
      var emitter = new THREE.ParticleSystem(particle_geometry, particle_material);
      emitter.position = new THREE.Vector3(0, 0, -1200);
      emitter.sortParticles = false;
      scene.add(emitter);

      camera.position.z = 3;
      
      var clock = new THREE.Clock();

      var render = function () {
        requestAnimationFrame( render );

        mesh.rotation.y += 0.3 * clock.getDelta();

        renderer.render(scene, camera);
      };

      render();
  </script>
</body>
</html>
